# マルコフ連鎖文章生成 for Misskey (AiScript版)

Misskeyの中で動く、AiScriptで書かれたマルコフ連鎖文章生成スクリプトです。
あなたの過去のノートを学習して、あなたっぽい文章を自動生成します！

## 特徴

- **完全にMisskey内で動作**: Misskey Playで実行できます
- **簡単に使える**: スクリプトをコピー&ペーストするだけ
- **カスタマイズ可能**: 設定を変更して好みの文章を生成
- **プライバシー保護**: データはあなたのブラウザ内でのみ処理されます

## 用意されているスクリプト

### 1. `markov_generator_simple.aiscript` - シンプル版

**おすすめ度**: ⭐⭐⭐⭐⭐ (初心者向け)

最もシンプルで動作が軽いバージョンです。

- 2文字単位のマルコフ連鎖
- 50件のノートを学習
- 3つの文章を生成

**こんな人におすすめ**:
- とりあえず試してみたい
- シンプルなスクリプトが好き
- 動作の軽さを重視

### 2. `markov_generator_advanced.aiscript` - 高度版

**おすすめ度**: ⭐⭐⭐⭐ (中級者向け)

より自然な文章を生成できる高機能バージョンです。

- 単語単位または文字単位のマルコフ連鎖
- 100件のノートを学習
- 5つの文章を生成
- 詳細な設定が可能

**こんな人におすすめ**:
- より自然な文章を生成したい
- 細かく設定をカスタマイズしたい
- たくさんノートを投稿している

### 3. `markov_generator.aiscript` - オリジナル版

**おすすめ度**: ⭐⭐⭐ (実験用)

最初に作成したバージョン。実験的な実装が含まれています。

## 使い方

### ステップ1: Misskey Playを開く

1. Misskeyにログインします
2. メニューから「Play」を選択します
3. 「新規作成」をクリックします

### ステップ2: スクリプトをコピー

初めての方は `markov_generator_simple.aiscript` を使うことをおすすめします。

1. このリポジトリから好きなスクリプトファイルを開きます
2. 全文をコピーします

### ステップ3: 実行

1. Misskey Playのエディタにスクリプトを貼り付けます
2. タイトルをつけます（例：「マルコフ文章生成」）
3. 「実行」ボタンをクリックします

### ステップ4: 結果を見る

スクリプトが実行されると、以下のような流れで処理が行われます：

1. あなたのノートをAPIで取得
2. テキストをクリーニング（URL、メンションなどを除去）
3. マルコフチェーンモデルを構築
4. ランダムに文章を生成
5. 結果を表示

## 出力例

```
📝 マルコフ連鎖文章生成を開始します

⏳ ノートを取得中...（最大50件）
✅ 50件のノートを取得しました

🔨 マルコフモデルを構築中...
✅ 45件のノートから523個のパターンを学習しました

✨ 文章を生成します...

--- 生成された文章 ---

1. 今日はいい天気ですね。散歩に行きたい気分です。

2. プログラミングは楽しいけど、たまには休憩も必要だと思う。

3. お腹が空いたのでラーメンを食べに行こうかな。

--- 完了 ---

💡 この文章はあなたのノートから学習して生成されました
```

## カスタマイズ方法

### 高度版 (advanced) の設定変更

スクリプトの最初の方にある `CONFIG` オブジェクトを編集します：

```aiscript
var CONFIG = {
	fetch_limit: 100        // 取得するノート数（1-100）
	markov_order: 2         // N-gramのN（大きいほど元の文章に近くなる）
	max_length: 100         // 生成する最大長
	min_length: 10          // 生成する最小長
	generate_count: 5       // 生成する文章の数
	use_word_tokens: true   // true: 単語単位, false: 文字単位
}
```

#### パラメータの説明

- **fetch_limit**: 学習するノートの数
  - 多いほど多様な文章が生成されますが、処理時間が長くなります
  - 推奨値: 50-100

- **markov_order**: マルコフ連鎖の次数
  - 2: より創造的な文章（元の文章から離れる）
  - 3: より元の文章に近い文章
  - 推奨値: 2

- **max_length**: 生成する文章の最大長
  - 長いほど長文が生成されます
  - 推奨値: 50-150

- **min_length**: 生成する文章の最小長
  - 短すぎる文章を防ぎます
  - 推奨値: 10-20

- **generate_count**: 生成する文章の数
  - 好きな数に設定できます
  - 推奨値: 3-10

- **use_word_tokens**: トークン化の方法
  - true: 単語単位（英語や分かち書きに適している）
  - false: 文字単位（日本語に適している）
  - 推奨値: false（日本語の場合）

## トラブルシューティング

### 「データ不足」と表示される

**原因**: 学習できるノートが少なすぎます

**解決方法**:
- もっとノートを投稿してください
- `fetch_limit` を増やしてください
- `min_length` を減らしてください

### 「エラー: API呼び出しエラー」と表示される

**原因**: Misskey Playで実行していない可能性があります

**解決方法**:
- Misskey Play で実行してください
- ブラウザのコンソールでエラーを確認してください

### 文章が不自然すぎる

**原因**: 学習データが少ないか、パラメータが適切でない可能性があります

**解決方法**:
- `fetch_limit` を増やしてください
- `markov_order` を 3 に変更してください
- もっとノートを投稿してください

### 生成された文章が元の文章とほぼ同じ

**原因**: `markov_order` が大きすぎるか、学習データが少ない可能性があります

**解決方法**:
- `markov_order` を 2 に減らしてください
- `fetch_limit` を増やしてください

## 仕組みの説明

### マルコフ連鎖とは？

マルコフ連鎖は、「現在の状態」から「次の状態」を確率的に決定する手法です。

このスクリプトでは：

1. **学習フェーズ**: あなたのノートから「2文字（または2単語）の組み合わせの後に、どんな文字（または単語）が来るか」というパターンを学習します

   例：「今日は」の後には「いい」「晴れ」「寒い」などが来る

2. **生成フェーズ**: ランダムに開始点を選び、学習したパターンに基づいて次の文字（または単語）を選択し続けます

   例：「今日は」→「いい」→「天気」→「です」→「ね」→「。」

### プライバシーについて

このスクリプトは：

- ✅ あなたのブラウザ内でのみ実行されます
- ✅ データはどこにも送信されません
- ✅ Misskey APIで自分のノートのみを取得します
- ✅ 学習したモデルはメモリ上にのみ存在し、保存されません

安心してお使いください！

## 制限事項

- Misskey APIの制限により、一度に取得できるノートは最大100件です
- AiScriptの実行時間制限により、大量のデータを処理すると途中で停止する可能性があります
- 日本語の形態素解析を行わないため、本格的なマルコフ連鎖に比べて精度は劣ります

## 改善のアイデア

以下のような改善が可能です：

- [ ] 句読点での文の分割をより賢く
- [ ] 絵文字の扱いを改善
- [ ] 生成された文章の品質評価
- [ ] 特定の単語で始まる文章を生成
- [ ] 学習データのフィルタリング（特定の期間など）

## ライセンス

このスクリプトは、このリポジトリのメインプロジェクトと同じライセンスで提供されます。

## クレジット

このAiScript版は、Pythonで書かれた[markov-generator-fedi](../)プロジェクトを元に、
Misskey内で動作するように移植したものです。

---

**楽しいマルコフ文章生成ライフを！** 🎉

質問やバグ報告は、GitHubのIssueでお願いします。
